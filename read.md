Сценарии конвертор иностранных валют.

Допущения:
- разобьем на 2 части: конвертер и график стоимости валюты. считаем что они независимы
- все остальное на сайте кроме этих двух частей не трогаем и не проверям

По факту тут скорее регрессионные тесты, то есть фиксирование текущего состояния сервиса тестами, так как он уже написан и работает.

Окружение:
- по хорошему хорошо бы знать статистику браузеров с которых ходят на этот сайт и топовые из них проверять. Скорее всего в топе: Хром, Яндекс браузер, FireFox, Opera, так же возможно safari, ie/edge, + мобильные браузеры Chrome, ucbrowser, samsung browser. По хорошему тестируем в этих браузерах на двух последних версиях и одной бете, если таковая есть, чтоб знать что в следующей версии у нас все не разломается.
- возможно следует проверить заход на эту страницу пользователей с самыми распространенными расширениями, которые что-то меняют в дом-дереве сайта, например, блокировщиками рекламы, если они ломают наш сайт - пишем жалобу на них на форуме, пусть правят. Если на прошлых версиях сайта этого не повторяется, тогда возможно придется переименовать пару элементов на странице на которые срабатывает фильтр, чтоб выпустить версию сайта.

1 часть (сам конвертер):
 тесты:
 - поле Сумма принимает только цифровые значения от 0 до 999 999 999 999 и разделитель (запятая). В качестве негативных тестов пробуем ввести буквы/отрицательные значения, любые печатаемые знаки, можно попробовать вставить из таблицы символов что-то еще
 - в списке валют из которых конвертировать проверяем что все представленные в нем валюты можно выбрать. Если выбрать валюту равную той в которую конвертируем, то предыдущая выбранная валюта из которой проходила конвертация встанет на место валюты в которую конвертируем.
 - в списке валют в которых конвертировать проверяем что все представленные в нем валюты можно выбрать. Если выбрать валюту равную той из которой конвертируем, то предыдущая выбранная валюта в которую проходила конвертация встанет на место валюты из которой конвертируем.
 - При смене валют, даже с пустым полем суммы, справа обновляется табличка в которой указан текущий курс этой валюты к Рублю, если обе валюты НЕ Рубль, то в таблице должно быть 2 строки по одной на каждую из валют. Ниже обновляется таблица с курсами этих валют.
 - остальные кучу параметров надо знать что значат. Вижу что при разных комбинациях они влияют на результат, но где взять формулу рассчета и подтвердить/опровергнуть его не понятно. Так что в тестах оставлю их по умолчанию, для тестирования их надо наверное знать ТЗ и отсюда уже
 - то же самое и с графиком валют, чтоб понять что он верно отрисовался, нужен какой-то базис с чем сравнивать.
 - Пакеты услуг доступны только доя usd/rub/eur если выбрана другая валюта то появится предупреждение у графы пакет услуг
 - При выборе любого пакета услуг появляется предурпеждение в таблице предупреждения валют
 - при нажатии на ссылку "таблица измерения котировок" появляется всплывающее окно
 - Таблица изменения котировок закрывается только кнопкой закрыть, клик вне ее не закрывает ее




 так как мы можем перехватить запрос в браузере на конвертаци валют, то смотрим что в нем передается:
 curl 'http://www.sberbank.ru/portalserver/proxy/?pipe=shortCachePipe&url=http%3A%2F%2Flocalhost%2Frates-web%2FrateService%2Frate%2Fconversion%3FregionId%3D77%26sourceCode%3Dcard%26destinationCode%3Daccount%26exchangeType%3Dibank%26servicePack%3Dempty%26fromCurrencyCode%3D978%26toCurrencyCode%3D%26amount%3D999999999999' -H 'Pragma: no-cache' -H 'Accept-Encoding: gzip, deflate' -H 'Accept-Language: en-US,en;q=0.9,ru;q=0.8' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3450.0 Safari/537.36' -H 'Accept: */*' -H 'Cache-Control: no-cache' -H 'X-Requested-With: XMLHttpRequest' -H 'Connection: keep-alive' -H 'Referer: http://www.sberbank.ru/ru/quotes/converter' --compressed

 изменяем сумму на какую-то содержащую букву и получаем ошибку 500:
 Error 500: java.lang.NoSuchMethodError: javax/ws/rs/ClientErrorException.validate&#40;Ljavax/ws/rs/core/Response&#59;Ljavax/ws/rs/core/Response$Status$Family&#59;&#41;Ljavax/ws/rs/core/Response&#59;

 что неприятно потому что бэкенд нам рассказывает на чем он написан
 так же можно попробовать поиграться с параметрами и посмотреть возможна ли тут sql-инъекция, если за запросом курса бэкэнд каждый раз, к примеру, ходит в базу

 кстати если мы выполним такой запрос:
 curl 'http://www.sberbank.ru/portalserver/proxy/?pipe=shortCachePipe&url=http%3A%2F%2Flocalhost%2Frates-web%2FrateService%2Frate%2Fconversion%3FregionId%3D77%26sourceCode%3Dcard%26destinationCode%3Daccount%26exchangeType%3Dbank%26servicePack%3Dempty%26fromCurrencyCode%3D978%26toCurrencyCode%3D%26amount%3D99999999999' -H 'Pragma: no-cache' -H 'Accept-Encoding: gzip, deflate' -H 'Accept-Language: en-US,en;q=0.9,ru;q=0.8' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3450.0 Safari/537.36' -H 'Accept: */*' -H 'Cache-Control: no-cache' -H 'X-Requested-With: XMLHttpRequest' -H 'Connection: keep-alive' -H 'Referer: http://www.sberbank.ru/ru/quotes/converter' --compressed -v
 в котром сменили exchangeType=ibank на exchangeType=bank, то мы увидим что выдается корректная ошибка 500:
 {"status":500,"errorCode":"UNKNOWN_ERROR","message":"","currentDatetime":"05.08.2018 14-35"}
 что значит выше мы правда нашли ошибку и 500-ки с трейсом быть не должно

